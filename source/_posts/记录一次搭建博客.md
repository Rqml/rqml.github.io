---
title: 记录一次搭建博客
date: 2024-08-14 20:44:51
updated:
tags: 
  - 博客
categories: 
  - 碎碎念
  - 博客 
keywords:
description:
top_img:
comments:
cover:
toc:
toc_number:
toc_style_simple:
copyright:
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
mathjax:
katex:
aplayer:
highlight_shrink:
aside:
abcjs:
---

> 博客使用静态博客框架[Hexo](https://hexo.io/zh-cn/)+主题[Butterfly](https://butterfly.js.org/)搭建，托管到[Github](https://github.com/)，需要提前安装[Git](https://git-scm.com/)，[Node.js](https://nodejs.org/zh-cn)哦

## 1、Hexo

### 安装

打开终端，使用如下命令行安装即可。遇到网络超时，可能需要“科学上网”

```bash
npm install -g hexo-cli
```

### 初始化

在自己的盘符下新建文件夹，例如我的`E:\qiing-blog`，在该目录下打开终端，进行初始化项目

```bash
hexo init
```

初始化成功之后，根目录下会新增许多文件，大致如下

```
public 最终所见网页的所有内容
node_modules 插件以及hexo所需node.js模块
_config.yml 站点配置文件，设定一些公开信息等
package.json 应用程序信息，配置hexo运行所需js包
scaffolds 模板文件夹，新建文章，会默认包含对应模板内容
themes 存放主题文件，hexo根据主题生成静态网页（速度贼快）
source 用于存放用户资源，后续新增的文章就在在该目录的_posts文件夹下生成
```

启动博客服务，继续在根目录下

```bash
hexo s
# 默认端口为4000，如果无法正常启动，更换端口，hexo s -p 4001
```

浏览器访问`http://localhost:4000/`本地预览，默认是`hexo`内置的`landscape`主题

![](https://qiniu.qiing.wang/827a7d03aeec46a29e0fd9e315dc0fc2.gif)

## 2、主题

[官方主题库](https://hexo.io/themes/)有许多主题，博客使用`butterfly`主题布局

### 主题主页

![](https://qiniu.qiing.wang/09ab60bd347540ca9bbe317babdaeaac.gif)

在项目根目录下使用`git`安装，若无法使用`git`，可将`git安装目录`添加至系统环境变量

```bash
git clone -b master https://gitee.com/immyw/hexo-theme-butterfly.git themes/butterfly
```

等待安装完成，**themes**目录下就会新增**butterfly**文件夹

![](https://qiniu.qiing.wang/image-20240814220621026.png)

继续安装`pug`和`stylus`渲染器

```bash
npm install hexo-renderer-pug hexo-renderer-stylus --save
```

### 修改配置文件

根目录下找到**_config.yml**文件，修改主题为**butterfly**（注意**yml**文件格式），**注意冒号后面的空格**

![](https://qiniu.qiing.wang/image-20240814221131307.png)

### 本地预览

```bash
hexo clean #清除缓存
hexo g     # 生成静态文件
hexo s     # 启动服务
```

![](https://qiniu.qiing.wang/9d5acea822264f5d92d866944a0ae7d0.gif)

### 博客个性化设置

参照**butterfly**官方文档进行设置，这里略过

## 3、GitHub Pages

### 新建仓库

仓库名称必须为`用户名小写.github.io`

![](https://qiniu.qiing.wang/image-20240814222909245.png)

### Setting

在仓库设置中找到**Pages**

![](https://qiniu.qiing.wang/image-20240814223637140.png)

### 修改YML

> 这里要注意**branch**一定要与仓库分支一致(**main**)

![](https://qiniu.qiing.wang/image-20240814223859555.png)

### 部署

安装`hexo-deployer-git`插件

```bash
 npm install hexo-deployer-git --save
```

依次执行命令

```bash
hexo clean 
hexo g # 生成静态文件
hexo s #本地预览，没有问题之后结束本地预览（Ctrl+C）
hexo d #部署项目
```

如果在执行`hexo d`时出现**spawn failed**错误，解决方式如下

![](https://qiniu.qiing.wang/image-20240820013708278.png)

- 删除`.deploy_git`文件之后
- 执行命令行`git config --global core.autocrlf false`
- 最后：`hexo d`

### 预览

部署之后，大概要等10分钟左右，就可以使用http://rmql.github.io 访问博客了

## 4、图床

写作过程中，会用到很多图片，文章在部署之后，图片就无法本地访问了。因此使用图床存储图片，将本地图片转换成链接地址。博客使用[七牛云](https://www.qiniu.com/)+[Typora](https://typoraio.cn/)+[PicGo](https://picgo.github.io/PicGo-Doc/zh/)方案

> 使用**七牛云**方案，需要有自己的域名；如果没有个人域名的话，就要考虑别的方案

### 七牛云

进入**七牛云**官网，点击**产品**，选择**对象存储**。需提前注册并实名认证

![](https://qiniu.qiing.wang/image-20240819230801533.png)

进入**对象存储**配置界面，新建**存储空间**

![](https://qiniu.qiing.wang/image-20240819231215648.png)

新建空间之后，因为**七牛云**官方给的**域名**只能使用一个月，所以最好绑定**自己的域名**，免得后面麻烦

> 这里如果使用的国内域名，则需要进行ICP备案才能绑定，具体操作流程，对应自己的域名注册商手册，自行查阅备案

![](https://qiniu.qiing.wang/image-20240819231701403.png)

域名绑定成功之后，复制这里的**CNAME**，到自己的域名注册商网站进行**DNS解析配置**，这里略。解析成功之后，就可以使用**自己的域名**了

在七牛云官网里知道找到**密钥管理**，后面配置**PicGo**需用

![](https://qiniu.qiing.wang/image-20240819232338418.png)

其实到这里还没有结束，我全部搞完部署之后发现，博客中的图片无法显示出来，网上查询得知，浏览器会将HTTP协议自动转为HTTPS，所以图片显示不出来。所以这里我们要给七牛配置SSL证书了。

> 我的域名是阿里云的，所以SSL证书也在阿里云申请，方便，而且阿里云为个人网站提供了免费SSL证书（挺香）。[申请链接](https://yundun.console.aliyun.com/?p=cas#/certExtend/free/)

**个人测试证书（原免费证书）**>**立即购买**>**个人测试证书**>**个人测试证书（免费版）**>**立即购买**

![](https://qiniu.qiing.wang/image-20240825220904213.png)

**个人测试证书（原免费证书）**>**创建证书**

![](https://qiniu.qiing.wang/image-20240825221328744.png)

等待审核、签发通过之后，下载证书到本地，并解压，会有三个文件（\*\*.key、\*\*\_chain.crt、\*\*\_public.crt）

![](https://qiniu.qiing.wang/image-20240825223345196.png)

**配置HTTPS**

![](https://qiniu.qiing.wang/image-20240825221915011.png)

**访问控制开启https**>**上传新SSL证书**

![](https://qiniu.qiing.wang/image-20240825222459388.png)

上传从阿里云下载的证书

![](https://qiniu.qiing.wang/image-20240825222338141.png)

**配置HTTPS**>**更换证书**（添加给七牛云配置的证书）>**确定**

![](https://qiniu.qiing.wang/image-20240825222602433.png)

### PicGo

下载好**PicGo**之后，**图床设置**>**七牛云**>**编辑按钮**

![](https://qiniu.qiing.wang/image-20240819225927749.png)

进入**PicGo**的**七牛云**配置，完成之后点击**确认**就OK了

1. 图床配置名：自己随便起个名
2. 设定AccessKey：密钥管理中的**AK**
3. 设定SecretKey：密钥管理中的**SK**
4. 设定的Bucket：七牛云存储空间名
5. 设定的访问网址：绑定的自己的域名，使用**https**协议
6. 设定存储区域：默认**z0**

![](https://qiniu.qiing.wang/image-20240825223038426.png)

### Typora

在**Typora**编辑器中，打开**偏好设置**，选择**图像**，设置如下图所示

![](https://qiniu.qiing.wang/image-20240819224657015.png)

> 以后我们在写博客时，直接复制或插入图片，Typora会自动将图片上传至七牛云，并转义引用URL

## 5、备份

> 这里将整个博客项目也备份到仓库下，方便管理。在根目录下执行**Git**命令

新建分支

```bash
# 仓库初始化
git init
# 新建分支
git checkout -b hexo
# 与远程分支建立连接
git remote add origin https://github.com/Rqml/rqml.github.io
```

推送分支

```bash
# 添加所有文件到暂缓区
git add .
# 提交
git commit -m "提交信息"
# 推送
git push origin hexo
```

> 之后就可以同时管理了两个分支了
>
> main -负责博客静态网页
>
> hexo -备份整个博客项目

## 6、写作&更新

### 写作

```bash
# 新建文章，根目录下执行
hexo new "一篇新文章"
```

然后就能发现一个**md**文件已生成，`E:\qiing_blog\source\_posts\一篇新文章.md`，之后就可以使用**Typora**愉快写作了，博客中使用的图片可以自动上传至我们的图床

### 更新

更新博客静态页面

```bash
hexo clean # 清除缓存，可跳过
hexo g
hexo s # 在部署之前先本地运行看下，没问题再部署
hexo d
```

更新博客项目

```
git add .
git commit -m "提交信息"
git push origin hexo
```

